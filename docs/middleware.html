<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-middleware/introduction" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.1">
<title data-rh="true">introduction | Aether</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://quamatic.github.io/aether/docs/middleware"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="introduction | Aether"><meta data-rh="true" name="description" content="Middleware allow you to customize the behavior of the positioning and be as granular as you want, adding your own custom logic."><meta data-rh="true" property="og:description" content="Middleware allow you to customize the behavior of the positioning and be as granular as you want, adding your own custom logic."><link data-rh="true" rel="canonical" href="https://quamatic.github.io/aether/docs/middleware"><link data-rh="true" rel="alternate" href="https://quamatic.github.io/aether/docs/middleware" hreflang="en"><link data-rh="true" rel="alternate" href="https://quamatic.github.io/aether/docs/middleware" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/aether/blog/rss.xml" title="Aether RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/aether/blog/atom.xml" title="Aether Atom Feed"><link rel="stylesheet" href="/aether/assets/css/styles.cb9a1749.css">
<script src="/aether/assets/js/runtime~main.2fc29dd9.js" defer="defer"></script>
<script src="/aether/assets/js/main.157d3fb2.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_daut" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/aether/"><b class="navbar__title text--truncate">Aether</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/aether/docs/getting-started">Documentation</a><a class="navbar__item navbar__link" href="/aether/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/quamatic/aether" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_LcrU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_Zd1C colorModeToggle_Q2UZ"><button class="clean-btn toggleButton_snSK toggleButtonDisabled_uibi" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_Xfwf"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_eNHI"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_L17O"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_D4XZ"><div class="docsWrapper_Nnnt"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_HcMV" type="button"></button><div class="docRoot_iCwS"><aside class="theme-doc-sidebar-container docSidebarContainer_WcBp"><div class="sidebarViewport_XVQs"><div class="sidebar_FzEq"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_H5QY"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/aether/docs/getting-started">Getting Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/aether/docs/installation">Installation</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/aether/docs/guides/processing">Guides</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/aether/docs/guides/processing">Processing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/aether/docs/guides/updating">Updating</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/aether/docs/guides/collisions">Collisions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/aether/docs/guides/virtual-elements">Virtual Elements</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible menu__list-item-collapsible--active"><a class="menu__link menu__link--sublist menu__link--active" aria-current="page" href="/aether/docs/middleware">Middleware</a><button aria-label="Collapse sidebar category &#x27;Middleware&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/aether/docs/middleware/offset">offset</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/aether/docs/middleware/flip">flip</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/aether/docs/middleware/auto-placement">autoPlacement</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/aether/docs/middleware/shift">shift</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/aether/docs/middleware/size">size</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/aether/docs/middleware/hide">hide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/aether/docs/middleware/arrow">arrow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/aether/docs/middleware/inline">inline</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/aether/docs/utility">Utility</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/aether/docs/types">Types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/aether/docs/react">React Bindings</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/aether/docs/vide">Vide Bindings</a></li></ul></nav></div></div></aside><main class="docMainContainer_prS1"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_UBgY"><div class="docItemContainer_nQdC"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_gUIZ" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/aether/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_reHf"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Middleware</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_Z1OM theme-doc-toc-mobile tocMobile_KMtD"><button type="button" class="clean-btn tocCollapsibleButton_geF6">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Middleware</h1></header>
<p>Middleware allow you to customize the behavior of the positioning and be as granular as you want, adding your own custom logic.</p>
<p><code>process()</code> starts with initial positioning via <code>placement</code> — then middleware are executed as an in-between “middle” step of the initial placement computation and eventual return of data for rendering.</p>
<h2 class="anchor anchorWithStickyNavbar_asMC" id="example">Example<a href="#example" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h2>
<div class="tabs-container tabList_scTV"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_tmPb tabs__item--active">luau</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_tmPb">roblox-ts</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_FS4i"><div class="language-luau codeBlockContainer_OfeH theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_jWbD"><pre tabindex="0" class="prism-code language-luau codeBlock_IfGL thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_r3eV"><span class="token-line" style="color:#393A34"><span class="token plain">local Aether = require(path.to.aether)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">local shiftByOnePixel: Aether.Middleware = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name = &quot;shiftByOnePixel&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    run = function(state)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            x = state.x + 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            y = state.y + 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_noyv"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_yebG" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EunA"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_XjP4"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_FS4i" hidden=""><div class="language-typescript codeBlockContainer_OfeH theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_jWbD"><pre tabindex="0" class="prism-code language-typescript codeBlock_IfGL thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_r3eV"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> process</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> </span><span class="token class-name">Middleware</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;@rbxts/aether&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> shiftByOnePixel</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Middleware </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;shiftByOnePixel&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function-variable function" style="color:#d73a49">run</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">state</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        x</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">x </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        y</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">y </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_noyv"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_yebG" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EunA"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_XjP4"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div>
<p>This (not particularly useful) middleware adds <code>1</code> pixel to the coordinates. To use this middleware, add it to your <code>middleware</code> array:</p>
<div class="tabs-container tabList_scTV"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_tmPb tabs__item--active">luau</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_tmPb">roblox-ts</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_FS4i"><div class="language-luau codeBlockContainer_OfeH theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_jWbD"><pre tabindex="0" class="prism-code language-luau codeBlock_IfGL thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_r3eV"><span class="token-line" style="color:#393A34"><span class="token plain">local Aether = require(path.to.aether)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Aether.process(reference, target, {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    middleware = { shiftByOnePixel }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">})</span><br></span></code></pre><div class="buttonGroup_noyv"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_yebG" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EunA"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_XjP4"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_FS4i" hidden=""><div class="language-typescript codeBlockContainer_OfeH theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_jWbD"><pre tabindex="0" class="prism-code language-typescript codeBlock_IfGL thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_r3eV"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> process </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;@rbxts/aether&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">process</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">reference</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> target</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    middleware</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">shiftByOnePixel</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_noyv"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_yebG" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EunA"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_XjP4"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_asMC" id="shape">Shape<a href="#shape" class="hash-link" aria-label="Direct link to Shape" title="Direct link to Shape">​</a></h2>
<p>This is the shape of the <code>Middleware</code> type:</p>
<div class="tabs-container tabList_scTV"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_tmPb tabs__item--active">luau</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_tmPb">roblox-ts</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_FS4i"><div class="language-luau codeBlockContainer_OfeH theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_jWbD"><pre tabindex="0" class="prism-code language-luau codeBlock_IfGL thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_r3eV"><span class="token-line" style="color:#393A34"><span class="token plain">type Middleware&lt;T&gt; = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name: string,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    run: (state: MiddlewareState) =&gt; MiddlewareResult&lt;T&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_noyv"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_yebG" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EunA"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_XjP4"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_FS4i" hidden=""><div class="language-typescript codeBlockContainer_OfeH theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_jWbD"><pre tabindex="0" class="prism-code language-typescript codeBlock_IfGL thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_r3eV"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">Middleware</span><span class="token class-name operator" style="color:#393A34">&lt;</span><span class="token class-name constant" style="color:#36acaa">T</span><span class="token class-name operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function-variable function" style="color:#d73a49">run</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">state</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> MiddlewareState</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> MiddlewareResult</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token constant" style="color:#36acaa">T</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_noyv"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_yebG" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EunA"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_XjP4"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_asMC" id="name"><code>name</code><a href="#name" class="hash-link" aria-label="Direct link to name" title="Direct link to name">​</a></h3>
<p>A <strong>unique</strong> name that identifies the middleware. If the middleware generates a result containing data, this name will be used as the key for that data in the result.</p>
<h3 class="anchor anchorWithStickyNavbar_asMC" id="run"><code>run</code><a href="#run" class="hash-link" aria-label="Direct link to run" title="Direct link to run">​</a></h3>
<p>The function executed when the middleware is processed.</p>
<h2 class="anchor anchorWithStickyNavbar_asMC" id="middleware-state">Middleware State<a href="#middleware-state" class="hash-link" aria-label="Direct link to Middleware State" title="Direct link to Middleware State">​</a></h2>
<p>An object is passed to <code>run</code> containing useful data about the middleware lifecycle being executed.</p>
<p>In the previous examples, we destructured <code>x</code> and <code>y</code> out of the <code>run</code> parameter object. These are only two properties that get passed into middleware, but there are many more.</p>
<p>The properties passed are below:</p>
<div class="tabs-container tabList_scTV"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_tmPb tabs__item--active">luau</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_tmPb">roblox-ts</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_FS4i"><div class="language-luau codeBlockContainer_OfeH theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_jWbD"><pre tabindex="0" class="prism-code language-luau codeBlock_IfGL thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_r3eV"><span class="token-line" style="color:#393A34"><span class="token plain">type MiddlewareState = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    x: number,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    y: number,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    initialPlacement: Placement,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    placement: Placement,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    data: MiddlewareData,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    elements: ElementRefs,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rects: ElementRects,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rtl: boolean,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cache: Cache,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_noyv"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_yebG" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EunA"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_XjP4"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_FS4i" hidden=""><div class="language-typescript codeBlockContainer_OfeH theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_jWbD"><pre tabindex="0" class="prism-code language-typescript codeBlock_IfGL thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_r3eV"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">MiddlewareState</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    x</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    y</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    initialPlacement</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Placement</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    placement</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Placement</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    data</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> MiddlewareData</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    elements</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> ElementRefs</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rects</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> ElementRects</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rtl</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">boolean</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cache</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Cache</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_noyv"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_yebG" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EunA"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_XjP4"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_asMC" id="x"><code>x</code><a href="#x" class="hash-link" aria-label="Direct link to x" title="Direct link to x">​</a></h3>
<p>This is the current x-axis coordinate to position the floating element to.</p>
<h3 class="anchor anchorWithStickyNavbar_asMC" id="y"><code>y</code><a href="#y" class="hash-link" aria-label="Direct link to y" title="Direct link to y">​</a></h3>
<p>This is the current y-axis coordinate to position the floating element to.</p>
<h3 class="anchor anchorWithStickyNavbar_asMC" id="initialplacement"><code>initialPlacement</code><a href="#initialplacement" class="hash-link" aria-label="Direct link to initialplacement" title="Direct link to initialplacement">​</a></h3>
<p>The initial (or preferred) placement passed in to <code>process()</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_asMC" id="placement"><code>placement</code><a href="#placement" class="hash-link" aria-label="Direct link to placement" title="Direct link to placement">​</a></h3>
<p>The stateful resultant placement. Middleware like <code>flip()</code> change <code>initialPlacement</code> to a new one.</p>
<h3 class="anchor anchorWithStickyNavbar_asMC" id="data"><code>data</code><a href="#data" class="hash-link" aria-label="Direct link to data" title="Direct link to data">​</a></h3>
<p>This is an object containing all the data of any middleware at the current step in the lifecycle. The lifecycle loops over the <code>middleware</code> array, so later middleware have access to data from any middleware run prior.</p>
<h3 class="anchor anchorWithStickyNavbar_asMC" id="elements"><code>elements</code><a href="#elements" class="hash-link" aria-label="Direct link to elements" title="Direct link to elements">​</a></h3>
<p>This is an object containing the reference and floating elements.</p>
<h3 class="anchor anchorWithStickyNavbar_asMC" id="rects"><code>rects</code><a href="#rects" class="hash-link" aria-label="Direct link to rects" title="Direct link to rects">​</a></h3>
<p>This is an object containing the <code>Rect</code>s of the reference and floating elements, an object of shape <code>{ width, height, x, y }</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_asMC" id="rtl"><code>rtl</code><a href="#rtl" class="hash-link" aria-label="Direct link to rtl" title="Direct link to rtl">​</a></h3>
<p>The right-to-left boolean flag passed in to <code>process()</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_asMC" id="cache"><code>cache</code><a href="#cache" class="hash-link" aria-label="Direct link to cache" title="Direct link to cache">​</a></h3>
<p>The cache used for storing elements and scales during the lifecycle.</p>
<h2 class="anchor anchorWithStickyNavbar_asMC" id="ordering">Ordering<a href="#ordering" class="hash-link" aria-label="Direct link to Ordering" title="Direct link to Ordering">​</a></h2>
<p>The order in which middleware are placed in the array matters, as middleware use the coordinates that were returned from previous ones. This means they perform their work based on the current positioning state.</p>
<p>Three <code>shiftByOnePixel</code> in the middleware array means the coordinates get shifted by 3 pixels in total:</p>
<div class="tabs-container tabList_scTV"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_tmPb tabs__item--active">luau</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_tmPb">roblox-ts</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_FS4i"><div class="language-luau codeBlockContainer_OfeH theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_jWbD"><pre tabindex="0" class="prism-code language-luau codeBlock_IfGL thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_r3eV"><span class="token-line" style="color:#393A34"><span class="token plain">local Aether = require(path.to.aether)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">local shiftByOnePixel: Aether.Middleware = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name = &quot;shiftByOnePixel&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    run = function(state)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            x = state.x + 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            y = state.y + 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    end,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Aether.proess(reference, target, {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    middleware = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        shiftByOnePixel,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        shiftByOnePixel,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        shiftByOnePixel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">})</span><br></span></code></pre><div class="buttonGroup_noyv"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_yebG" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EunA"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_XjP4"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_FS4i" hidden=""><div class="language-typescript codeBlockContainer_OfeH theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_jWbD"><pre tabindex="0" class="prism-code language-typescript codeBlock_IfGL thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_r3eV"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> process</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> </span><span class="token class-name">Middleware</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;@rbxts/aether&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> shiftByOnePixel</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Middleware </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;shiftByOnePixel&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function-variable function" style="color:#d73a49">run</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">state</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        x</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">x </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        y</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">y </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">process</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">reference</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> target</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    middleware</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        shiftByOnePixel</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        shiftByOnePixel</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        shiftByOnePixel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_noyv"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_yebG" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EunA"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_XjP4"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div>
<p>If the later <code>shiftByOnePixel</code> implementations had a condition based on the current value of <code>x</code> and <code>y</code>, the condition can change based on their placement in the array.</p>
<p>Understanding this can help in knowing which order to place middleware in, as placing a middleware before or after another can produce a different result.</p>
<h2 class="anchor anchorWithStickyNavbar_asMC" id="resetting-the-lifecycle">Resetting the lifecycle<a href="#resetting-the-lifecycle" class="hash-link" aria-label="Direct link to Resetting the lifecycle" title="Direct link to Resetting the lifecycle">​</a></h2>
<p>There are use cases for needing to reset the middleware lifecycle so that other middleware perform fresh logic.</p>
<ul>
<li>When <code>flip()</code> and <code>autoPlacement()</code> change the placement, they reset the lifecycle so that other middleware that modify the coordinates based on the current placement do not perform stale logic.</li>
<li><code>size()</code> resets the lifecycle with the newly applied dimensions, as many middleware read the dimensions to perform their logic.</li>
</ul>
<p>In order to do this, add a <code>reset</code> property to the returned object from <code>fn</code>.</p>
<div class="tabs-container tabList_scTV"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_tmPb tabs__item--active">luau</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_tmPb">roblox-ts</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_FS4i"><div class="language-luau codeBlockContainer_OfeH theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_jWbD"><pre tabindex="0" class="prism-code language-luau codeBlock_IfGL thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_r3eV"><span class="token-line" style="color:#393A34"><span class="token plain">type Reset = true | {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    placement: Placement?,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rects: true | ElementRects?,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_noyv"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_yebG" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EunA"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_XjP4"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_FS4i" hidden=""><div class="language-typescript codeBlockContainer_OfeH theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_jWbD"><pre tabindex="0" class="prism-code language-typescript codeBlock_IfGL thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_r3eV"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> </span><span class="token class-name">Reset</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        placement</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> Placement</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        rects</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> ElementRects</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_noyv"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_yebG" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_EunA"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_XjP4"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div>
<p>The <code>Reset</code> type offers two modes for resetting behavior:</p>
<ol>
<li><code>true</code> – A complete reset of all middleware computations, without introducing new state.</li>
<li><strong>An object</strong> – Allows selective resetting with additional options for customization.</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_asMC" id="object-properties">Object Properties<a href="#object-properties" class="hash-link" aria-label="Direct link to Object Properties" title="Direct link to Object Properties">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_asMC" id="placement-1"><code>placement</code><a href="#placement-1" class="hash-link" aria-label="Direct link to placement-1" title="Direct link to placement-1">​</a></h4>
<p>Specifies the starting placement after resetting.</p>
<h4 class="anchor anchorWithStickyNavbar_asMC" id="rects-1"><code>rects</code><a href="#rects-1" class="hash-link" aria-label="Direct link to rects-1" title="Direct link to rects-1">​</a></h4>
<p>Controls how the <code>rects</code> of elements are recomputed:</p>
<p>When set to <code>true</code>, the <code>rects</code> will automatically be re-computed. Otherwise, you can return your own new <code>rects</code>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/quamatic/aether/tree/main/website/docs/middleware/introduction.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_VSjo" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_Tt9E"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/aether/docs/guides/virtual-elements"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Virtual Elements</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/aether/docs/middleware/offset"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">offset</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents__SaS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#example" class="table-of-contents__link toc-highlight">Example</a></li><li><a href="#shape" class="table-of-contents__link toc-highlight">Shape</a><ul><li><a href="#name" class="table-of-contents__link toc-highlight"><code>name</code></a></li><li><a href="#run" class="table-of-contents__link toc-highlight"><code>run</code></a></li></ul></li><li><a href="#middleware-state" class="table-of-contents__link toc-highlight">Middleware State</a><ul><li><a href="#x" class="table-of-contents__link toc-highlight"><code>x</code></a></li><li><a href="#y" class="table-of-contents__link toc-highlight"><code>y</code></a></li><li><a href="#initialplacement" class="table-of-contents__link toc-highlight"><code>initialPlacement</code></a></li><li><a href="#placement" class="table-of-contents__link toc-highlight"><code>placement</code></a></li><li><a href="#data" class="table-of-contents__link toc-highlight"><code>data</code></a></li><li><a href="#elements" class="table-of-contents__link toc-highlight"><code>elements</code></a></li><li><a href="#rects" class="table-of-contents__link toc-highlight"><code>rects</code></a></li><li><a href="#rtl" class="table-of-contents__link toc-highlight"><code>rtl</code></a></li><li><a href="#cache" class="table-of-contents__link toc-highlight"><code>cache</code></a></li></ul></li><li><a href="#ordering" class="table-of-contents__link toc-highlight">Ordering</a></li><li><a href="#resetting-the-lifecycle" class="table-of-contents__link toc-highlight">Resetting the lifecycle</a><ul><li><a href="#object-properties" class="table-of-contents__link toc-highlight">Object Properties</a></li></ul></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>